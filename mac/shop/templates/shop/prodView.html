{% extends 'shop/basic.html' %}

{% block title%} {{product.product_name}} - MyAwesomeCart {% endblock %}

{% block css %}
<style>
:root {
  --primary: #4361ee;
  --primary-dark: #3a56d4;
  --secondary: #7209b7;
  --accent: #4cc9f0;
  --light: #f8f9fa;
  --dark: #212529;
  --gray: #6c757d;
  --light-gray: #e9ecef;
  --border: #e0e0e0;
  --shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
  --radius: 12px;
  --transition: all 0.3s ease;
}

.product-detail-container {
  max-width: 1200px;
  margin: 2rem auto;
  padding: 0 15px;
}

.product-detail-card {
  background: white;
  border-radius: var(--radius);
  overflow: hidden;
  box-shadow: var(--shadow);
}

.product-main {
  display: flex;
  flex-wrap: wrap;
  gap: 2rem;
  padding: 2rem;
}

.product-gallery {
  flex: 1;
  min-width: 300px;
}

.product-image-main {
  width: 100%;
  height: 400px;
  display: flex;
  align-items: center;
  justify-content: center;
  background: var(--light-gray);
  border-radius: var(--radius);
  overflow: hidden;
  margin-bottom: 1rem;
}

.product-image-main img {
  max-width: 100%;
  max-height: 100%;
  object-fit: contain;
}

.product-thumbnails {
  display: flex;
  gap: 0.5rem;
  justify-content: center;
}

.thumbnail {
  width: 70px;
  height: 70px;
  border: 2px solid var(--border);
  border-radius: 8px;
  overflow: hidden;
  cursor: pointer;
  transition: var(--transition);
  display: flex;
  align-items: center;
  justify-content: center;
  background: white;
}

.thumbnail:hover, .thumbnail.active {
  border-color: var(--primary);
}

.thumbnail img {
  max-width: 100%;
  max-height: 100%;
  object-fit: contain;
}

.product-info {
  flex: 1;
  min-width: 300px;
}

.product-title {
  font-size: 1.8rem;
  font-weight: 700;
  color: var(--dark);
  margin-bottom: 0.5rem;
  line-height: 1.3;
}

.product-price {
  font-size: 1.5rem;
  font-weight: 700;
  color: var(--primary);
  margin-bottom: 1rem;
}

.product-rating {
  display: flex;
  align-items: center;
  gap: 0.5rem;
  margin-bottom: 1.5rem;
}

.stars {
  color: #ffc107;
}

.rating-count {
  color: var(--gray);
  font-size: 0.9rem;
}

.product-description {
  color: var(--gray);
  line-height: 1.6;
  margin-bottom: 1.5rem;
}

.product-features {
  margin-bottom: 1.5rem;
}

.feature-list {
  list-style: none;
  padding: 0;
}

.feature-list li {
  padding: 0.5rem 0;
  display: flex;
  align-items: center;
  gap: 0.5rem;
}

.feature-list li:before {
  content: "✓";
  color: var(--primary);
  font-weight: bold;
}

.quantity-selector {
  display: flex;
  align-items: center;
  gap: 1rem;
  margin-bottom: 1.5rem;
}

.quantity-label {
  font-weight: 600;
  color: var(--dark);
}

.quantity-controls {
  display: flex;
  align-items: center;
  border: 1px solid var(--border);
  border-radius: 6px;
  overflow: hidden;
}

.quantity-btn {
  width: 40px;
  height: 40px;
  background: var(--light);
  border: none;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  transition: var(--transition);
  font-size: 1.2rem;
}

.quantity-btn:hover {
  background: var(--light-gray);
}

.quantity-input {
  width: 60px;
  height: 40px;
  border: none;
  text-align: center;
  font-weight: 600;
  background: white;
}

.product-actions {
  display: flex;
  gap: 1rem;
  flex-wrap: wrap;
}

.btn {
  padding: 0.75rem 1.5rem;
  border-radius: 8px;
  font-weight: 600;
  transition: var(--transition);
  border: none;
  cursor: pointer;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  gap: 0.5rem;
  font-size: 1rem;
  flex: 1;
  min-width: 160px;
}

.btn-primary {
  background-color: var(--primary);
  color: white;
}

.btn-primary:hover {
  background-color: var(--primary-dark);
  transform: translateY(-2px);
  box-shadow: 0 4px 8px rgba(67, 97, 238, 0.3);
}

.btn-secondary {
  background-color: white;
  color: var(--primary);
  border: 2px solid var(--primary);
}

.btn-secondary:hover {
  background-color: rgba(67, 97, 238, 0.1);
  transform: translateY(-2px);
}

.product-meta {
  display: flex;
  gap: 2rem;
  margin-top: 1.5rem;
  padding-top: 1.5rem;
  border-top: 1px solid var(--border);
}

.meta-item {
  display: flex;
  align-items: center;
  gap: 0.5rem;
  color: var(--gray);
  font-size: 0.9rem;
}

.meta-item i {
  color: var(--primary);
}

.product-tabs {
  margin-top: 2rem;
}

.tabs-header {
  display: flex;
  border-bottom: 1px solid var(--border);
  margin-bottom: 1.5rem;
}

.tab {
  padding: 1rem 1.5rem;
  background: none;
  border: none;
  font-weight: 600;
  color: var(--gray);
  cursor: pointer;
  transition: var(--transition);
  position: relative;
}

.tab.active {
  color: var(--primary);
}

.tab.active:after {
  content: '';
  position: absolute;
  bottom: -1px;
  left: 0;
  width: 100%;
  height: 3px;
  background: var(--primary);
}

.tab:hover {
  color: var(--primary);
}

.tab-content {
  padding: 0 1rem 1.5rem;
}

.tab-pane {
  display: none;
}

.tab-pane.active {
  display: block;
}

.specs-table {
  width: 100%;
  border-collapse: collapse;
}

.specs-table tr {
  border-bottom: 1px solid var(--border);
}

.specs-table td {
  padding: 0.75rem 0;
}

.specs-table td:first-child {
  font-weight: 600;
  width: 30%;
  color: var(--dark);
}

.review {
  padding: 1.5rem 0;
  border-bottom: 1px solid var(--border);
}

.review:last-child {
  border-bottom: none;
}

.review-header {
  display: flex;
  justify-content: space-between;
  margin-bottom: 0.5rem;
}

.review-author {
  font-weight: 600;
}

.review-date {
  color: var(--gray);
  font-size: 0.9rem;
}

.review-rating {
  color: #ffc107;
  margin-bottom: 0.5rem;
}

.related-products {
  margin-top: 4rem;
}

.section-title {
  font-size: 1.5rem;
  font-weight: 700;
  margin-bottom: 1.5rem;
  color: var(--dark);
}

.related-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
  gap: 1.5rem;
}

.related-card {
  background: white;
  border-radius: var(--radius);
  overflow: hidden;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
  transition: var(--transition);
}

.related-card:hover {
  transform: translateY(-5px);
  box-shadow: 0 10px 20px rgba(0, 0, 0, 0.12);
}

.related-image {
  height: 180px;
  display: flex;
  align-items: center;
  justify-content: center;
  background: var(--light-gray);
  padding: 1rem;
}

.related-image img {
  max-width: 100%;
  max-height: 100%;
  object-fit: contain;
}

.related-info {
  padding: 1rem;
}

.related-title {
  font-size: 1rem;
  font-weight: 600;
  margin-bottom: 0.5rem;
  color: var(--dark);
  display: -webkit-box;
  -webkit-line-clamp: 2;
  -webkit-box-orient: vertical;
  overflow: hidden;
  height: 2.8rem;
}

.related-price {
  font-weight: 700;
  color: var(--primary);
}

/* Responsive Design */
@media (max-width: 768px) {
  .product-main {
    flex-direction: column;
    padding: 1rem;
  }
  
  .product-image-main {
    height: 300px;
  }
  
  .product-title {
    font-size: 1.5rem;
  }
  
  .product-actions {
    flex-direction: column;
  }
  
  .btn {
    min-width: auto;
  }
  
  .product-meta {
    flex-direction: column;
    gap: 1rem;
  }
  
  .tabs-header {
    overflow-x: auto;
    white-space: nowrap;
  }
}

@media (max-width: 576px) {
  .product-detail-container {
    margin: 1rem auto;
  }
  
  .product-title {
    font-size: 1.3rem;
  }
  
  .product-price {
    font-size: 1.3rem;
  }
  
  .related-grid {
    grid-template-columns: repeat(2, 1fr);
    gap: 1rem;
  }
}

/* Animation for page load */
@keyframes fadeIn {
  from {
    opacity: 0;
    transform: translateY(20px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.product-detail-card {
  animation: fadeIn 0.5s ease forwards;
}

/* Success message */
.added-to-cart-message {
  position: fixed;
  top: 20px;
  right: 20px;
  background: var(--primary);
  color: white;
  padding: 1rem 1.5rem;
  border-radius: 8px;
  box-shadow: var(--shadow);
  display: flex;
  align-items: center;
  gap: 0.5rem;
  z-index: 1000;
  transform: translateX(150%);
  transition: transform 0.3s ease;
}

.added-to-cart-message.show {
  transform: translateX(0);
}
</style>
{% endblock %}

{% block body%}
<div class="product-detail-container">
  <div class="product-detail-card">
    <div class="product-main">
      <div class="product-gallery">
        <div class="product-image-main">
          <img src="/media/{{product.image}}" alt="{{product.product_name}}" id="main-product-image">
        </div>
        <div class="product-thumbnails">
          <div class="thumbnail active" data-image="/media/{{product.image}}">
            <img src="/media/{{product.image}}" alt="Thumbnail 1">
          </div>
          <!-- Additional thumbnails would go here in a real implementation -->
          <div class="thumbnail" data-image="/media/{{product.image}}">
            <img src="/media/{{product.image}}" alt="Thumbnail 2">
          </div>
          <div class="thumbnail" data-image="/media/{{product.image}}">
            <img src="/media/{{product.image}}" alt="Thumbnail 3">
          </div>
        </div>
      </div>
      
      <div class="product-info">
        <h1 class="product-title">{{product.product_name}}</h1>
        
        <div class="product-rating">
          <div class="stars">
            ★★★★☆
          </div>
          <span class="rating-count">(128 reviews)</span>
        </div>
        
        <div class="product-price">${{product.price}}</div>
        
        <div class="product-description">
          {{product.desc}}
        </div>
        
        <div class="product-features">
          <ul class="feature-list">
            <li>High-quality materials</li>
            <li>30-day money-back guarantee</li>
            <li>Free shipping on orders over $50</li>
            <li>24/7 customer support</li>
          </ul>
        </div>
        
        <div class="quantity-selector">
          <span class="quantity-label">Quantity:</span>
          <div class="quantity-controls">
            <button class="quantity-btn minus">-</button>
            <input type="number" class="quantity-input" value="1" min="1" max="10">
            <button class="quantity-btn plus">+</button>
          </div>
        </div>
        
        <div class="product-actions">
          <button class="btn btn-primary cart" id="pr{{product.id}}">
            <i class="fas fa-shopping-cart"></i> Add to Cart
          </button>
          <button class="btn btn-secondary">
            <i class="fas fa-bolt"></i> Buy Now
          </button>
        </div>
        
        <div class="product-meta">
          <div class="meta-item">
            <i class="fas fa-shipping-fast"></i>
            <span>Free shipping</span>
          </div>
          <div class="meta-item">
            <i class="fas fa-undo"></i>
            <span>30-day returns</span>
          </div>
          <div class="meta-item">
            <i class="fas fa-shield-alt"></i>
            <span>2-year warranty</span>
          </div>
        </div>
      </div>
    </div>
    
    <div class="product-tabs">
      <div class="tabs-header">
        <button class="tab active" data-tab="description">Description</button>
        <button class="tab" data-tab="specifications">Specifications</button>
        <button class="tab" data-tab="reviews">Reviews (128)</button>
      </div>
      
      <div class="tab-content">
        <div class="tab-pane active" id="description">
          <p>{{product.desc}}</p>
          <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.</p>
          <p>Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>
        </div>
        
        <div class="tab-pane" id="specifications">
          <table class="specs-table">
            <tr>
              <td>Material</td>
              <td>Premium Quality</td>
            </tr>
            <tr>
              <td>Dimensions</td>
              <td>10 x 5 x 3 inches</td>
            </tr>
            <tr>
              <td>Weight</td>
              <td>1.2 lbs</td>
            </tr>
            <tr>
              <td>Color</td>
              <td>As shown in image</td>
            </tr>
            <tr>
              <td>Warranty</td>
              <td>2 years</td>
            </tr>
          </table>
        </div>
        
        <div class="tab-pane" id="reviews">
          <div class="review">
            <div class="review-header">
              <span class="review-author">John Doe</span>
              <span class="review-date">March 15, 2023</span>
            </div>
            <div class="review-rating">★★★★★</div>
            <p>Excellent product! Exceeded my expectations. The quality is outstanding and it arrived quickly.</p>
          </div>
          
          <div class="review">
            <div class="review-header">
              <span class="review-author">Jane Smith</span>
              <span class="review-date">February 28, 2023</span>
            </div>
            <div class="review-rating">★★★★☆</div>
            <p>Very good product overall. The only minor issue was that the color was slightly different than in the picture, but still happy with my purchase.</p>
          </div>
        </div>
      </div>
    </div>
  </div>
  
  <div class="related-products">
    <h2 class="section-title">You May Also Like</h2>
    <div class="related-grid">
      <!-- These would be dynamic in a real implementation -->
      <div class="related-card">
        <div class="related-image">
          <img src="/media/{{product.image}}" alt="Related Product">
        </div>
        <div class="related-info">
          <h3 class="related-title">Similar Product 1</h3>
          <div class="related-price">${{product.price|add:"10"}}</div>
        </div>
      </div>
      
      <div class="related-card">
        <div class="related-image">
          <img src="/media/{{product.image}}" alt="Related Product">
        </div>
        <div class="related-info">
          <h3 class="related-title">Similar Product 2</h3>
          <div class="related-price">${{product.price|add:"5"}}</div>
        </div>
      </div>
      
      <div class="related-card">
        <div class="related-image">
          <img src="/media/{{product.image}}" alt="Related Product">
        </div>
        <div class="related-info">
          <h3 class="related-title">Similar Product 3</h3>
          <div class="related-price">${{product.price|add:"15"}}</div>
        </div>
      </div>
      
      <div class="related-card">
        <div class="related-image">
          <img src="/media/{{product.image}}" alt="Related Product">
        </div>
        <div class="related-info">
          <h3 class="related-title">Similar Product 4</h3>
          <div class="related-price">${{product.price}}</div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Success Message -->
<div class="added-to-cart-message" id="cart-message">
  <i class="fas fa-check-circle"></i>
  <span>Product added to cart successfully!</span>
</div>
{% endblock %}

{% block js%}
<script>
document.addEventListener('DOMContentLoaded', function() {
  // Initialize cart
  if(localStorage.getItem('cart') == null){
    var cart = {};
  } else {
    cart = JSON.parse(localStorage.getItem('cart'));
    updateCartCount();
  }
  
  // Thumbnail click handler
  document.querySelectorAll('.thumbnail').forEach(thumb => {
    thumb.addEventListener('click', function() {
      // Update active thumbnail
      document.querySelectorAll('.thumbnail').forEach(t => t.classList.remove('active'));
      this.classList.add('active');
      
      // Update main image
      const imageUrl = this.getAttribute('data-image');
      document.getElementById('main-product-image').src = imageUrl;
    });
  });
  
  // Quantity controls
  const quantityInput = document.querySelector('.quantity-input');
  const minusBtn = document.querySelector('.quantity-btn.minus');
  const plusBtn = document.querySelector('.quantity-btn.plus');
  
  minusBtn.addEventListener('click', function() {
    let value = parseInt(quantityInput.value);
    if (value > 1) {
      quantityInput.value = value - 1;
    }
  });
  
  plusBtn.addEventListener('click', function() {
    let value = parseInt(quantityInput.value);
    if (value < 10) {
      quantityInput.value = value + 1;
    }
  });
  
  // Tab functionality
  document.querySelectorAll('.tab').forEach(tab => {
    tab.addEventListener('click', function() {
      // Update active tab
      document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
      this.classList.add('active');
      
      // Show corresponding content
      const tabId = this.getAttribute('data-tab');
      document.querySelectorAll('.tab-pane').forEach(pane => pane.classList.remove('active'));
      document.getElementById(tabId).classList.add('active');
    });
  });
  
  // Add to cart functionality
  document.getElementById('pr{{product.id}}').addEventListener('click', function() {
    const idstr = this.id.toString();
    const quantity = parseInt(document.querySelector('.quantity-input').value);
    
    if(cart[idstr] != undefined) {
      cart[idstr] = cart[idstr] + quantity;
    } else {
      cart[idstr] = quantity;
    }
    
    localStorage.setItem('cart', JSON.stringify(cart));
    updateCartCount();
    
    // Show success message
    showCartMessage();
    
    // Update button text temporarily
    const originalText = this.innerHTML;
    this.innerHTML = '<i class="fas fa-check"></i> Added to Cart';
    this.disabled = true;
    
    setTimeout(() => {
      this.innerHTML = originalText;
      this.disabled = false;
    }, 2000);
  });
  
  // Buy now button
  document.querySelector('.btn-secondary').addEventListener('click', function() {
    // Add to cart first
    const idstr = document.getElementById('pr{{product.id}}').id.toString();
    const quantity = parseInt(document.querySelector('.quantity-input').value);
    
    if(cart[idstr] != undefined) {
      cart[idstr] = cart[idstr] + quantity;
    } else {
      cart[idstr] = quantity;
    }
    
    localStorage.setItem('cart', JSON.stringify(cart));
    updateCartCount();
    
    // Redirect to checkout
    window.location.href = '/shop/checkout';
  });
  
  // Update cart count in navbar
  function updateCartCount() {
    let totalItems = 0;
    for (let item in cart) {
      totalItems += cart[item];
    }
    document.getElementById('cart').innerHTML = totalItems;
  }
  
  // Show cart message
  function showCartMessage() {
    const message = document.getElementById('cart-message');
    message.classList.add('show');
    
    setTimeout(() => {
      message.classList.remove('show');
    }, 3000);
  }
  
  // Initialize popover
  $('#popcart').popover();
});
</script>
{% endblock %}